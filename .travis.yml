language: c

matrix:
  include:
    - dist: trusty
    - dist: xenial

env:
  global:
    export DEBEMAIL=t_glaessle@gmx.de
    export DEBFULLNAME="Thomas Gläßle"

addons:
  apt:
    packages:
      - build-essential
      - devscripts
      - debhelper
      - gnupg
      - fakeroot
      - dput

install:
  - openssl aes-256-cbc
        -K $encrypted_2472284bc835_key
        -iv $encrypted_2472284bc835_iv
        -in .travis/private.key.enc
        -out .travis/private.key -d
  - gpg --import .travis/private.key

script:
  - . /etc/lsb-release
  - sed -i "s/) [a-z]*;/~ubuntu$DISTRIB_RELEASE) $DISTRIB_CODENAME;/" debian/changelog
  - make

deploy:
  provider: script
  skip_cleanup: true
  script: make upload
  on:
    tags: true
